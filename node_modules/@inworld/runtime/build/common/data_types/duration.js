"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DurationSchema = void 0;
const zod_1 = require("zod");
const durationRegex = /^(\d+)(ms|s|m|h)$/;
/**
 * @internal
 * Converts a numeric millisecond value into a human-readable duration string.
 * @param ms - Duration in milliseconds
 * @returns A string with the appropriate unit (ms, s, m, h)
 */
function msToDurationString(ms) {
    if (ms < 1000)
        return `${ms}ms`;
    if (ms < 60000)
        return `${(ms / 1000).toFixed(0)}s`;
    if (ms < 3600000)
        return `${(ms / 60000).toFixed(0)}m`;
    return `${(ms / 3600000).toFixed(0)}h`;
}
exports.DurationSchema = zod_1.z
    .union([
    zod_1.z.string().regex(durationRegex, {
        message: "Invalid duration format. Expected formats like '10s', '1m', '500ms', '2h'",
    }),
    zod_1.z.number(),
])
    .transform((value) => {
    if (typeof value === 'number') {
        return msToDurationString(value);
    }
    return value;
});
